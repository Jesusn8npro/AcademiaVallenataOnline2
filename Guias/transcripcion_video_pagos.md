(6) Implementar pasarela de pago Epayco con Node js en Colombia - YouTube
https://www.youtube.com/watch?v=qgDbvAh7ygM

Transcript:
(00:00) para poder utilizar la pasarela de pago y Pay Nos dirigimos a la página de ellos y nos dirigimos a crear una cuenta aquí nos piden los datos los datos nos podemos eh registrar con Google o con Facebook después de eso nos pide datos personales y nos llega una confirmación al correo después de confirmar eh eso que nos llega el correo ya nos da acceso al dashboard así de esta forma y aquí dentro del dashboard para poder utilizar eh los servicios de la pasarela con una aplicación Nos dirigimos aquí al loguito del del
(00:51) usuario y nos vamos a configuración personalizaciones nos vamos hasta donde están las llaves secretas y vamos a utilizar estas dos public key y private key que son para el onpage checkout que esto es un método que aquí lo Como se muestra en la documentación es un una ventanita que se abre dentro de la misma tienda está el standar checkout este se abre dentro de una pestaña aparte pero en este caso vamos a utilizar el onpage checkout porque ya nos ofrece todo el el diseño como tal todo el ui que necesitamos para
(01:26) eh tenerlo completo Entonces les voy a explicar cómo tengo configurado pues la aplicación donde utilizo este H page checkout eh Esa es la es la aplicación como tal entonces eh normal como cualquier otra tienda Entonces por ejemplo añadimos esta estas zapatillas le creamos una se crea una orden para pagar y este botoncito de de aquí lo que hace es desplegar como tal el Home page checkout como se ve ahí al darle click va a desplegarse el ya como tal el onpage checkout que ya me da acceso a toda la funcionalidad y no tengo que
(02:15) hacer nada más entonces para poder implementar este cosito en esta en esta página en esta vista que se ve aquí hay que ponerle el siguiente Script que es este Script donde en el source va la URL el checkout de pik que es esta y estas otras dos que es el la k la PR Ke son las kys que teníamos ya en ipico aquí las puse como variables de entorno y ya las ponemos Aquí esta clase es por defecto esta este ID es de la orden que que yo tengo guardada en mi en mi base de datos para poder relacionarlo con los datos que se que se suban en el en en la
(03:09) pasarela IP el monto de la orden estos son los impuestos se pueden poner en cero si no maneja impuestos eh yo le puse test como como nombre Para probarlo eh aquí en la descripción le puse el nombre del producto pues sa ver Qué producto es que se está hablando el tipo de moneda eh pesos colombianos eh esto quiere decir que ese modo de prueba s o sea test está true Aquí muy importante la las URL de respuestas esta URL respuesta es una página una página así como esta que se ve aquí como tal donde nos llega la respuesta Pues de
(03:51) ipq entonces es para mostrar personalizadamente al cliente después de que el cliente haga la transacción y le de finalizar para poder mostrársela eh Ya como nosotros queramos con el estilo que nosotros queramos y todo entonces él se encarga de enviarnos una referencia que aquí yo lo utilizo con esta URL la confirmación donde está la URL y esta la referencia de pago que me llega entonces eh llega en la query Entonces yo la saco de la cuer y la pongo aquí y la consulto entonces me llega toda la Data de la transacción y esta URL confirmación es
(04:34) esta también entrega datos de la transacción pero esta es por medio de backing en este caso Este es mi backing y este es mi controlador eh para la petición get entonces también lo envía por query y lo mismo eh lo estructuro y lo que saco es la respuesta Lo que me interesa Y el ID de la factura para hacer exactamente lo mismo de allá entonces yo lo que hago es H ya mandarle aquí para que me eh si la si la respuesta es la que yo espero como aceptada Entonces el coja esta referencia este ID de la factura y me la
(05:12) ponga como pagada Porque allá en IP ya aparece como pagada porque ya me envió esta respuesta Este es un estilo de botón pero no hace falta aquí pues yo estoy utilizando mi propio botón Entonces yo le hice una trampita para con este html for Poner este estilo este botón del estilo que yo prefiera y hacer como si estuviera hundiéndome de referencia y aquí el método de confirmación O sea qué método de confirmación yo le puse get le podemos poner get o post eh la verdad pues yo ya le había puesto así entonces Entonces lo
(06:00) hice con el ejemplo así el doc billing es pues el documento Pues de de de la persona que compró y esto es lo mismo la identificación de la persona que compró aquí le puse le quemé estos datos pero por el ejemplo el nombre y y el apellido se lo puse aquí en el en el nombre del del comprador y y el teléfono todos estos datos son los que pid yp en este eh hpage pero ya él se encarga de hacer todo lo demás o sea es muy sencillo implementarlo y estas serían las cosas a tener en cuenta dentro de nuestra aplicación no es mucho pero toca que
(06:40) tener en cuenta todas esas todas estas eh toda esta configuración eh Para ejemplo lo voy a vo a apagar aquí entonces é nos pide acá un un correo entonces la persona pone su correo esto guarda solo también los correos allá entonces para saber qu qué Qué tarjetas de prueba hay uno se va acá la documentación y hay aquí donde dice transacciones de pruebas eh Por acá hay una URL donde le da unas tarjetas de pruebas que es esta Entonces le damos clic aquí y nos da el ejemplo de varias tarjetas a fondo insuficiente fallida pendiente entonces
(07:34) eh con esto ya podemos testearlo entonces por ejemplo aquí le puse eh esta esta tarjeta con esta fecha de aspiración y este es el código de seguridad entonces aquí ya tiene la tarjeta guardada Como le digo Ahí se encarga yp de guardar todo y si le damos pagar y aquí ya aparece como aceptada la la la transacción si le damos finalizar él nos lleva aquí que esta es la url respuesta se acuerda que le había dicho que aquí mire por query le manda el ID de la referencia de pago entonces yo con ID de la referencia de pago consulto
(08:21) la información y ya se la muestro al ya se la muestro al comprador Pero dentro de mi tienda es algo personalizado y a la vez y y a la vez yo yo puedo ir a la a la orden como tal porque ya en mi en mi base de datos ya quedó pagada aquí le vo a mostrar estoy utilizando una base de datos de entonces aquí ya aparece pagada la esta orden Aquí les voy a mostrar simplemente así gráficamente para que se vea mejor Eh pues ya aparece pagada no entonces eh Se confirma por o sea lo redirige a la página también pero también se se le envía la petición al
(09:14) backing para que prácticamente en el tiempo que se hace la transferencia eh muestre el estado pues correcto lo que resta sería ir a revisar que en ipico tengamos esta esta orden pagada ya con su referencia nos vamos al dasb Y esa la última orden que tenemos por lo que miramos y y tiene el mismo tienen la misma referencia del cliente que es la del ID de la orden que yo tengo guardado en mi base de datos y aquí se puede mirar más detalles de la transacción y ya podríamos ver todo así Simplemente mirando la última transacción o aquí en
(10:21) detalle de transacciones apras También tenemos un buscador en el cual pues vamos a poner el ID de la orden y nos va a dar el detalle por si queremos ir a buscar órdenes específicas Entonces tenemos el ID la referencia del cliente que es el ID de la orden que nosotros tenemos en nuestro en nuestra base de datos y la referencia ipik que es como se guarda el ID del de la del P efectuado en IP y así quedaría implementado ya tendríamos para usarlo en producción conectarlo con una cuenta bancaria e como tiene Alianza J vivienda tiene
(11:12) algunos beneficios en las comisiones que cobra y en general es muy fácil de implementar esta pasarela Espero que este esta breve explicación les haya funcionado y pues nada Muchas gracias m