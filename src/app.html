<!doctype html>
<html lang="es" class="%sveltekit.theme%">
	<head>
		<meta charset="utf-8" />
		<!-- Compatibilidad navegadores antiguos -->
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<link rel="icon" href="%sveltekit.assets%/favicon.png" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		
		<!-- üöÄ PWA MANIFEST -->
		<link rel="manifest" href="/manifest.json" />
		
		<!-- üé® PWA META TAGS -->
		<meta name="theme-color" content="#1e40af" />
		<meta name="background-color" content="#ffffff" />
		<meta name="display" content="standalone" />
		
		<!-- üì± iOS SAFARI PWA -->
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="default" />
		<meta name="apple-mobile-web-app-title" content="Academia Vallenata" />
		<link rel="apple-touch-icon" href="/iconos-pwa/icon-192x192.png" />
		
		<!-- üñ•Ô∏è MICROSOFT TILES -->
		<meta name="msapplication-TileColor" content="#1e40af" />
		<meta name="msapplication-TileImage" content="/iconos-pwa/icon-144x144.png" />
		<meta name="msapplication-config" content="/browserconfig.xml" />
		
		<!-- SEO Meta Tags -->
		<meta name="description" content="Aprende a tocar acorde√≥n vallenato con la Academia Vallenata Online. Cursos profesionales, simulador interactivo y comunidad de estudiantes." />
		<meta name="keywords" content="academia vallenata, curso acorde√≥n, vallenato, m√∫sica, aprender acorde√≥n, clases online" />
		<meta name="author" content="Academia Vallenata Online" />
		
		<!-- Open Graph / Facebook -->
		<meta property="og:type" content="website" />
		<meta property="og:site_name" content="Academia Vallenata Online" />
		<meta property="og:title" content="Academia Vallenata Online - Aprende Acorde√≥n Vallenato" />
		<meta property="og:description" content="La mejor plataforma para aprender acorde√≥n vallenato. Cursos profesionales, simulador interactivo y comunidad de estudiantes." />
		<meta property="og:image" content="%sveltekit.assets%/images/og-image.jpg" />
		
		<!-- Twitter -->
		<meta property="twitter:card" content="summary_large_image" />
		<meta property="twitter:title" content="Academia Vallenata Online - Aprende Acorde√≥n Vallenato" />
		<meta property="twitter:description" content="La mejor plataforma para aprender acorde√≥n vallenato. Cursos profesionales, simulador interactivo y comunidad de estudiantes." />
		<meta property="twitter:image" content="%sveltekit.assets%/images/og-image.jpg" />
		
		<!-- ‚ö° Performance Optimizations -->
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link rel="preconnect" href="https://tbijzvtyyewhtwgakgka.supabase.co">
		<link rel="dns-prefetch" href="https://checkout.epayco.co">
		
		<!-- üì¶ Preload Critical Assets (solo recursos que existen) -->
		<link rel="preload" href="/favicon.png" as="image">
		<link rel="preload" href="/Acordeon PRO MAX.png" as="image" fetchpriority="high">
		
		<!-- üî§ Preload de fuente cr√≠tica para mejorar CLS -->
		<link rel="preload" href="https://fonts.gstatic.com/s/inter/v18/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuLyeMZhrib2Bg-4.woff2" as="font" type="font/woff2" crossorigin>
		<link rel="preload" href="https://fonts.gstatic.com/s/roboto/v30/KFOmCnqEu92Fr1Mu4mxKKTU1Kg.woff2" as="font" type="font/woff2" crossorigin>
		
		<!-- üé® Critical CSS Inline Optimizado -->
		<style>
			/* Critical CSS para LCP y evitar FOUC */
			*,*::before,*::after{box-sizing:border-box}
			html{line-height:1.15;-webkit-text-size-adjust:100%}
			body{margin:0;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:#f8fafc}
			
			/* Hero section cr√≠tico */
			.hero-container{min-height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white}
			.hero-content{text-align:center;max-width:600px;padding:2rem}
			.hero-title{font-size:3rem;font-weight:700;margin:0 0 1rem 0;text-shadow:0 2px 4px rgba(0,0,0,0.3)}
			.hero-subtitle{font-size:1.25rem;margin:0 0 2rem 0;opacity:0.9}
			.btn-primary{background:#ff6b35;color:white;padding:1rem 2rem;border-radius:50px;text-decoration:none;font-weight:600;display:inline-block;transition:transform 0.2s}
			.btn-primary:hover{transform:translateY(-2px)}
			
			/* Loading optimizado */
			.loading-spinner{display:flex;align-items:center;justify-content:center;height:100vh;font-size:18px;color:#3b82f6}
			.loading-spinner::after{content:'üéµ Cargando Academia Vallenata...'}
			
			/* Optimizaci√≥n de im√°genes */
			img{max-width:100%;height:auto;display:block}
			
			@media(max-width:768px){
				.hero-title{font-size:2rem}
				.hero-content{padding:1rem}
			}
		</style>
		
		<!-- Polyfill b√°sico para navegadores antiguos -->
		<script>
			// Solo funciones esenciales que pueden faltar
			if (!window.Promise) {
				document.write('<script src="https://cdn.jsdelivr.net/npm/promise-polyfill@8/dist/polyfill.min.js"><\/script>');
			}
			if (!Array.prototype.includes) {
				Array.prototype.includes = function(searchElement) {
					return this.indexOf(searchElement) !== -1;
				};
			}
		</script>
		
		<!-- ePayco SDK -->
		<script src="https://checkout.epayco.co/checkout.js"></script>
		
		%sveltekit.head%
		
		<!-- Script para inicializar tema antes de la carga -->
		<script>
			// Prevenir parpadeo del tema - Compatible con navegadores antiguos
			(function() {
				try {
					var tema = localStorage ? localStorage.getItem('tema-oscuro') : null;
					var modoOscuro = false;
					
					if (tema) {
						modoOscuro = JSON.parse(tema);
					} else if (window.matchMedia) {
						modoOscuro = window.matchMedia('(prefers-color-scheme: dark)').matches;
					}
					
					if (modoOscuro && document.documentElement.classList) {
						document.documentElement.classList.add('dark');
					} else if (modoOscuro && document.documentElement.className !== undefined) {
						// Fallback para navegadores sin classList
						document.documentElement.className += ' dark';
					}
				} catch (e) {
					// Fallback silencioso para cualquier error
				}
			})();
		</script>
		
		<!-- üöÄ PWA SERVICE WORKER (DESHABILITADO EN DEV) -->
		<script>
			// Solo registrar SW en producci√≥n para evitar conflictos con Lighthouse
			if ('serviceWorker' in navigator && location.protocol === 'https:') {
				window.addEventListener('load', async function() {
					try {
						const registration = await navigator.serviceWorker.register('/sw-optimized.js');
						console.log('üöÄ SW optimizado registrado en producci√≥n');
					} catch (error) {
						console.warn('‚ùå Error registrando SW:', error);
					}
				});
			} else {
				console.log('üîß SW deshabilitado en desarrollo para Lighthouse');
			}
		</script>
	</head>
	<body data-sveltekit-preload-data="hover" class="min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors">
		<div style="display: contents">%sveltekit.body%</div>
		
		<!-- üîî NOTIFICACIONES PWA -->
		<script>
			// Configurar notificaciones push (solo si est√°n soportadas)
			if ('Notification' in window && 'serviceWorker' in navigator) {
				// La l√≥gica espec√≠fica est√° en el store PWA
				console.log('üîî Notificaciones push disponibles');
			}
		</script>
	</body>
</html>
